#include<P18F452.INC>

ORG OX00
GOTO INICIO

ORG OX08
RETFIE

ORG 0X018
RETFIE

;DEFININDO ENTRADA E SAIDA

INICIO      MOVLW   b'00000100'
            MOVWF   TRISB
            CLRF    TRISD

;COMECO PROGRAMA

BOTAO       BTFSC   PORTB, 2    ;VERIFICA SE O BOTAO TA APERTADO OU SEJA EM 0
            GOTO    BOTAO   ;SE FOR 1 OU SEJA BOTAO SOLTO VOLTA PRO BOTAO
            CALL    DEBOUNCE
            BTFSC   PORTB, 2
            GOTO    BOTAO
            MOVLW   .14
            CPFSEQ  LATD    ;COMPARA O QUE TEM NO LATD COM O QUE TEM NO W
INCREMENTA  INCF    LATD, F ;INCREMENTA FILE LATD
PRESO       BTFSS   PORTB, 2 ;VERIFICA VALOR EM PORTB2
            GOTO    PRESO   ;SE TIVER EM 0, OU SEJA PRESSIONADO GOTO PRESO
            GOTO    BOTAO   ;SE TIVER EM 1, OU SEJA SOLTO GOTO BOTAO

;DEBOUNCE DE 100MS

DEBOUNCE    MOVLW .100
            MOVLWF OX80 

LOOP2       MOVLW   .250
            MOVLWF  0X81

LOOP1       NOP ;GASTA UM CICLO
            DECFSZ  0X81, F     ;INSTRUCAO DECREMENTA FILE, E SE CASO FOR 0 PULA PROXIMA INSTRUCAO
            GOTO    LOOP1       ;INSTRUCAO QUE E PULADA CASO 0X81 FOR 0
            DECFSZ  0X80, F     ;DECREMENTA 0X80 E SO RETORNA QUANDO OX80 FOR IGUAL A 0
            GOTO LOOP2
            RETURN




